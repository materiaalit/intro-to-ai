<!DOCTYPE html>
<html>
  <head>
    <title>Introduction to Artificial Intelligence 2020 | Part 5 Exercise 1</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">

    <link href="../stylesheets/styles-b17821ab.css" rel="stylesheet" />

    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/styles/xcode.min.css">

    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.1/cookieconsent.min.css" />

      <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47575342-7', 'auto');
  ga('set', 'anonymizeIp', true);
  ga('send', 'pageview');
</script>

  </head>
  <body>
    <div class="main-wrapper">
      <div class="header-wrapper">
        <div class="browser-support-warning" id="browser-support-warning" style="display: none;">
  Kaikki tämän materiaalin osat eivät välttämättä tuo nykyistä selaintasi. Voisitko harkita vaihtamista <a href="https://www.google.com/chrome/browser/desktop/" target="_blank" rel="noopener">Chrome</a> tai <a href="https://www.mozilla.org/en-US/firefox/new/" target="_blank" rel="noopener">Firefox</a> selaimeen?
  <span class="browser-support-warning__close">Selvä!</span>
</div>


        <nav class="navbar navbar-light bg-white">
  <a class="navbar-brand" href="http://mooc.fi" alt="MOOC" target="_blank" rel="noopener">
    <span class="icon-mooc"></span>
  </a>

  <ul class="nav navbar-nav hidden-md-down">
      <li class="nav-item ">
        <a href="../" class="nav-link" onclick="ga('send', 'event', 'navigation_topic_link', 'click', '#&lt;Middleman::Sitemap::Resource path=index.html&gt;')">Introduction</a>
      </li>
      <li class="nav-item ">
        <a href="../part1/" class="nav-link" onclick="ga('send', 'event', 'navigation_topic_link', 'click', '#&lt;Middleman::Sitemap::Resource path=part1.html&gt;')">Part 1</a>
      </li>
      <li class="nav-item ">
        <a href="../part2/" class="nav-link" onclick="ga('send', 'event', 'navigation_topic_link', 'click', '#&lt;Middleman::Sitemap::Resource path=part2.html&gt;')">Part 2</a>
      </li>
      <li class="nav-item ">
        <a href="../part3/" class="nav-link" onclick="ga('send', 'event', 'navigation_topic_link', 'click', '#&lt;Middleman::Sitemap::Resource path=part3.html&gt;')">Part 3</a>
      </li>
      <li class="nav-item ">
        <a href="../part4/" class="nav-link" onclick="ga('send', 'event', 'navigation_topic_link', 'click', '#&lt;Middleman::Sitemap::Resource path=part4.html&gt;')">Part 4</a>
      </li>
      <li class="nav-item ">
        <a href="../part5/" class="nav-link" onclick="ga('send', 'event', 'navigation_topic_link', 'click', '#&lt;Middleman::Sitemap::Resource path=part5.html&gt;')">Part 5</a>
      </li>
      <li class="nav-item ">
        <a href="../part6_ethics/" class="nav-link" onclick="ga('send', 'event', 'navigation_topic_link', 'click', '#&lt;Middleman::Sitemap::Resource path=part6_ethics.html&gt;')">Part 6</a>
      </li>
  </ul>

  <div class="float-xs-right navbar__buttons">
    <div class="dropdown" id="mobile-nav-dropdown">
      <button class="btn btn-secondary dropdown-toggle navbar__mobile-nav-toggle" data-toggle="dropdown">
        <i class="fa fa-bars"></i>
      </button>

      <div class="dropdown-menu">
      </div>
    </div>

    <button class="btn btn-secondary" id="table-of-contents-toggle">
      <span class="hidden-md-down">Table of contents</span>
      <i class="fa fa-ellipsis-h hidden-lg-up"></i>
    </button>

    <button class="btn btn-primary" id="tmc-login-toggle">Log in</button>
  </div>
</nav>

      </div>

      <div class="content-wrapper">
        <div class="container material" id="material">
            <div class="exercise-list">
  <div class="exercise-list__header">
    Exercises
  </div>

  <div class="exercise-list__content" id="exercise-list"></div>

</div>


          
<div class="hint">
  <div class="hint__header">
    <i class="fa fa-info-circle hint__icon"></i>Getting started with Weka
  </div>

  <div class="hint__body">
    
<p>
  Here you'll find instructions for installing and getting started with
  the Weka software. After going through this minitutorial, you'll be
  able to complete Exercises 5.1 and 5.2.
</p>


  </div>
</div>

<h1 class="material-heading">
    Installation

</h1>

<p>
  Download the Weka installation package from
  <a href="http://www.cs.waikato.ac.nz/~ml/weka/">here</a>, and run it
  to install Weka on your computer.
</p>

<p>
  Start Weka to get the following dialogue:
</p>
<img src="../img/screen/weka1-23371026.png" width=43%><br><br>

<h1 class="material-heading">
    Downloading and opening data

</h1>

<p>
  Download the Iris dataset <a href="https://materiaalit.github.io/intro-to-ai/files/iris.arff">here</a>. The file contains data about the iris flowers. The actual data comes after the metadata in the lines starting with %.
</p>

<pre>
@DATA
5.1,3.5,1.4,0.2,Iris-setosa
4.9,3.0,1.4,0.2,Iris-setosa
4.7,3.2,1.3,0.2,Iris-setosa
4.6,3.1,1.5,0.2,Iris-setosa
5.0,3.6,1.4,0.2,Iris-setosa
...
</pre>

<p>
  You can also download other <code>arff</code> files, which you can find
  by googling.</p>

<p>
  Now choose the <b>Explorer</b> application in Weka. You should
  get the following screen:
</p>
<img src="../img/screen/weka2-7a6b1123.png" width=100%><br><br>

<p>
  Now click <b>Open file...</b> and choose the <code>iris.arff</code>
  file that you just downloaded. You'll get the following screen:
</p>
<img src="../img/screen/weka3-7d0a5c6c.png" width=100%><br><br>

<p>
  The <i>Current relation</i> panel says that there are 150 data points,
  each of which has five attibutes (feature variables). A list of
  the variables is found in panel <i>Attributes</i>. Variables
  1&ndash;4 contain the width and length of the sepals and petals
  of the flowers. The fifth variable, <i>Class</i>, indicates the
  species of the flower: <i>iris setosa</i>, <i>iris versicolor</i>,
  or <i>iris virginica</i>.
</p>

<h1 class="material-heading">
    Visualizing the data

</h1>

<p>
  You may have heard about the importance of looking at the data
  before rushing into any data analysis.  Choose <b>Visualize</b> to
  get a scatter plot display showing all pairs of variables.
</p>
<img src="../img/screen/weka4-c95ea9c2.png" width=100%><br><br>

<p>
  Double click for example the middle figure on the second row from
  the top. This gives you a larger view of the plot showing
  variables <i>petal length</i> and <i>petal width</i>. In the
  plot, each point corresponds to one of the 150 data points in the
  data. The (x,y) coordinates are determined by the <i>petal length</i>
  and the <i>petal width</i> respectively. The color is determined
  by the species, i.e., variable <i>Class</i>.
</p>
<img src="../img/screen/weka5-72d5da9a.png" width=100%><br><br>

<p>
  It is useful to add some noise into the (x,y) coordinates so that
  points that may otherwise be hidden beneath other points located
  at the exact same coordintes become visible. This is done by
  using the <b>Jitter</b> slides.</p>

<p>
  As you can see above, the class <i>iris setosa</i> (blue) is clearly
  separated from the others. This is a good sign for classification
  purposes.
</p>

<h1 class="material-heading">
    Supervised learning: Classification

</h1>

<p>
  You can now close the scatter plot window and choose the <b>Classify</b>
  tab in the top bar.
</p>
<img src="../img/screen/weka6-a343e996.png" width=100%><br><br>

<p>
  In the panel <b>Classifier</b>, click <b>Choose</b>. You can now
  choose a classifier of your liking. Since we know the naive Bayes
  classifier already so well, let's use it. You'll find it
  under <b>Bayes</b> with the name <b>NaiveBayes</b>.
</p>
<img src="../img/screen/weka7-8ea55058.png" width=100%><br><br>

<p>
  Some classifiers have a number of parameters that you can adjust
  by clicking the name of the classifier in the panel <b>Classifier</b>.
  However, the naive Bayes classifier doesn't require any specific
  finetuning.
</p>

<p>
  In Weka the default is that the class variable, i.e., the variable
  that we will try to predict based on the other variables, is the
  last variable in the data. In other words, the variable <i>Class</i>
  will be the Y variable in our notation, while the others would be
  jointly denoted by X. In panel <b>Test options</b>, choose
  <b>Percentage split</b>. This means that the classifier will be
  trained on a randomly selected subset of 66&nbsp;% of the whole data, while
  the remaining 34&nbsp;% are used for testing.</p>

<p>Click <b>Start</b> to start the training and testing of the
  classifier. Since the data set is so small, and the naive Bayes
  classifier is very efficient, it only takes a short while to
  complete the process.
</p>
<img src="../img/screen/weka8-f04f02bd.png" width=100%><br><br>

<p>
  The output tell us that in the test set (n=51), 48 instances were
  correctly classified and three were misclassified. The
  <i>confusion matrix</i> at the bottom shows more specifically
  that two items in the class <i>iris virginica</i> were incorrectly
  classified as <i>iris versicolor</i>, and one item in
  <i>iris versicolor</i> was misclassified as <i>iris virginica</i>.
  All the 15 <i>iris setosa</i> instances were correctly classified.
  Can you think why that might be the case? <i>Hint:</i> Recall the
  scatter plot above.
</p>

<p>
  Next you should try out other classifiers such as the nearest
  neighbor classifier (<b>lazy/IB1</b>), decision tree
  (<b>trees/J48</b>), and multilayer perceptron (MLP)
  (<b>functions/MultiLayerPerceptron</b>).  The advantage of the
  decision tree classifier is its easy interpretation. You can access
  the classifier after training in the report under the heading <b>J48
  pruned tree</b>. You can read it directly as
  an <code>if-then-else</code> statement, where the classification
  decision is given after a colon <code>:</code>. For example, the
  following classifier says that if the <i>petal width</i> value is
  less than 0.6, the classification decision is <i>iris setosa</i>,
  and so forth.
<pre>
   petalwidth <= 0.6: Iris-setosa (50.0)
   petalwidth > 0.6
   |   petalwidth <= 1.7
   |   |   petallength <= 4.9: Iris-versicolor (48.0/1.0)
   |   |   petallength > 4.9
   |   |   |   petalwidth <= 1.5: Iris-virginica (3.0)
   |   |   |   petalwidth > 1.5: Iris-versicolor (3.0/1.0)
   |   petalwidth > 1.7: Iris-virginica (46.0/1.0)
</pre>
</p>

<p>
  In the case of the MLP, it is perhaps most interesting to examine
  the network architecture (structure). Click on the name of the
  classifier to view the settings. Set <code>GUI = True</code>. When
  you click <b>Start</b> after this, you will get a window that
  represents the network structure (see below). Here you must click
  <b>Start</b> in panel <b>Controls</b>, to train the classifier.
  (Unless you do so, and click <b>Accept</b>, the classifier will
  simply classify all items in class <i>iris virginica</i>.) After
  training, you can accept the classifier and study the results.
</p>
<img src="../img/screen/weka8-f04f02bd.png" width=100%><br><br>

<p>
  Note that especially if you build a complex network with many
  neurons or nodes, the training can take a while.
</p>

<h2 class="material-heading">
    Visualization of classification results

</h2>

<p>
  The next step is to take a closer look at the classification results.
  This way we can focus on the errors, and perhaps get some ideas about
  how to achieve even better results. Right click <b>Results list</b>
  for the classifier of your choice (where it says <i>right-click for
    options</i>), and choose <b>Visualize classifier errors</b>.
  Add jitter to the scatter plot to distinguish individual data points.
</p>
<img src="../img/screen/weka9-872939f2.png" width=100%><br><br>

<p>
  The y-axis shows the classification decision by the classifier
  (in the above case, the naive Bayes classifier), while the
  x-axis shows the actual class. You can see the same misclassified
  points as shown in the confusion matrix (above).
</p>

<p>
  To see what kind of instances were misclassified, we can change the
  variables on the x- and y-axes to be, e.g., <i>petal length</i>
  and <i>petal width</i> respectively. You can use the selectors at the
  top of the window to do this.
</p>
<img src="../img/screen/weka10-a161b610.png" width=100%><br><br>

<p>
  The misclassified instances show up as rectangles (highlighted above
  by a red circle). As you may have guessed, the misclassified
  instances are near the edges of the classes, and hence easy to
  mix up with the wrong class.
</p>

<h1 class="material-heading">
    Unsupervised learning: Clustering

</h1>

<p>
  You should now close the window displaying the classification
  results, and choose <b>Cluster</b> in the <i>Weka Explorer</i>
  dialogue. Since this is unsupervised learning, you should remove
  the class variable (the species of the flower). This is done by
  clicking <b>Ignore attributes</b> and choosing <b>class</b> in
  the resulting dialogue. Click <b>Select</b> to confirm your choice.
</p>

<p>
  Use the default clustering method, "EM", or choose another one
  from the menu -- for example, <b>SimpleKMeans</b> is a good, commonly
  used technique. Finally, click <b>Start</b> to get a report of the
  clustering results.
</p>
<img src="../img/screen/weka11-e035ec3a.png" width=100%><br><br>

<p>
  At the end of the report, you'll see among other things, how many
  clusters the method chose to cluster your data. In this case, the
  number is five. The first group ('0') contains 28 instances, the
  second ('1') contains 35, etc.
</p>

<p>
  To visualize the clustering results, right click the name of the
  method in <b>Result list</b>. A window will appear. Again, choose the
  variables to show on the x- and y-axes to be, e.g., <i>petal length</i>
  and <i>petal width</i>. A bit of jitter won't hurt.
</p>
<img src="../img/screen/weka12-42d07c07.png" width=100%><br><br>

<p>
  Groups 0 ja 3 (blue and cyan) cover the clearly separated <i>iris
    setosa</i> class. The other clusters split the remaining data
  into three parts. Since this is unsupervised learning, there is
  no guarantee, however, that the clusters would correspond to
  the class labels at all.
</p>

<p>
  Go ahead and try different classification and clustering methods.
  The exercise can be found in the beginning of
  <a href="../part5/">Part 5</a>.
</p>

        </div>
      </div>

      <div class="footer-wrapper">
        <footer class="footer">
  <div>
    This material is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons BY-NC-SA 4.0 License</a>.

  </div>

</footer>

      </div>
    </div>

    <div class="modal fade" id="tmc-login-modal" tabindex="-1" role="dialog">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <form id="tmc-login-form">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">Log in with your Test My Code Account</h4>
        </div>
        <div class="modal-body">
          <div class="alert alert-info">
            Don't have an account yet? <a href="https://tmc.mooc.fi/user/new" class="alert-link" target="_blank" rel="noopener">Create one!</a>
          </div>

          <div class="alert alert-danger" id="tmc-login-error" style="display: none;"></div>

          <div class="form-group">
            <label>Username</label>
            <input type="text" id="tmc-login-username" class="form-control" placeholder="Username"/>
          </div>

          <div class="form-group">
            <label>Password</label>
            <input type="password" id="tmc-login-password" class="form-control" placeholder="Password"/>
          </div>

          <div class="form-group">
            <label>Course</label>

            <div class="form-check">
              <label class="form-check-label">
                <input type="radio" class="form-check-input" name="tmcLoginCourse" value="intro-to-ai-20" checked>
                 Introduction to Artificial Intelligence 2020 (intro-to-ai-20)
              </label>
            </div>

            <small class="form-text text-muted">
              Course selection may affect the contents of the material.
            </small>
          </div>
        </div>
        <div class="modal-footer">
          <a class="btn btn-secondary" data-dismiss="modal">Close</a>
          <button type="submit" class="btn btn-primary">Log in</button>
        </div>
      </form>
    </div>
  </div>
</div>


    <div class="table-of-contents-layer" id="table-of-contents-layer">
</div>

<div class="table-of-contents" id="table-of-contents">
  <h1 class="table-of-contents__heading">
    Table of Contents
  </h1>

  <div class="table-of-contents__content">
    <ul id="table-of-contents-list"></ul>
  </div>
</div>


    <script>
  window._QUIZNATOR_ENABLED = true;
</script>

<script src="https://quiznator.mooc.fi/javascripts/plugin-loader.min.js"></script>


    <script src="https://code.jquery.com/jquery-3.1.1.min.js"
	    integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
	    crossorigin="anonymous"></script>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <script>
      window.SD_SHOW_SURVEY = ['part6', 'part7'].indexOf(window.location.pathname.replace(/\//g,'')) >= 0;
    </script>

    <script src="../javascripts/scripts-cb52849c.js"></script>

    <script src="https://use.fontawesome.com/ed2f73836b.js"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.7.0/highlight.min.js"></script>

    <script>hljs.initHighlightingOnLoad();</script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.1/cookieconsent.min.js"></script>
    <script src='//cdnjs.cloudflare.com/ajax/libs/diff_match_patch/20121119/diff_match_patch.js'></script>

    <script>window.cookieconsent.initialise({"palette":{"popup":{"background":"#000"},"button":{"background":"#f1d600"}}});</script>
  </body>
</html>
